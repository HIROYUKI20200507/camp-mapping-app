import{a as V,r as O,b as N,e as J,f as R,w as G,u as S,h as W,i as q,j as Y,k as F,l as E,m as j,p as z,o as _,q as g,F as D,s as L,t as f,v as k,x as X,y as Q,z as M}from"./entry.061f4e8d.js";const Z=()=>null;function tt(...s){var p;const n=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(n);let[r,e,t={}]=s;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof e!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=t.server??!0,t.default=t.default??Z,t.lazy=t.lazy??!1,t.immediate=t.immediate??!0;const a=V(),o=()=>a.isHydrating?a.payload.data[r]:a.static.data[r],c=()=>o()!==void 0;a._asyncData[r]||(a._asyncData[r]={data:O(o()??((p=t.default)==null?void 0:p.call(t))??null),pending:O(!c()),error:O(a.payload._errors[r]?N(a.payload._errors[r]):null)});const i={...a._asyncData[r]};i.refresh=i.execute=(y={})=>{if(a._asyncDataPromises[r]){if(y.dedupe===!1)return a._asyncDataPromises[r];a._asyncDataPromises[r].cancelled=!0}if(y._initial&&c())return o();i.pending.value=!0;const w=new Promise((l,m)=>{try{l(e(a))}catch(P){m(P)}}).then(l=>{if(w.cancelled)return a._asyncDataPromises[r];t.transform&&(l=t.transform(l)),t.pick&&(l=et(l,t.pick)),i.data.value=l,i.error.value=null}).catch(l=>{var m;if(w.cancelled)return a._asyncDataPromises[r];i.error.value=l,i.data.value=S(((m=t.default)==null?void 0:m.call(t))??null)}).finally(()=>{w.cancelled||(i.pending.value=!1,a.payload.data[r]=i.data.value,i.error.value&&(a.payload._errors[r]=N(i.error.value)),delete a._asyncDataPromises[r])});return a._asyncDataPromises[r]=w,a._asyncDataPromises[r]};const u=()=>i.refresh({_initial:!0}),d=t.server!==!1&&a.payload.serverRendered;{const y=W();if(y&&!y._nuxtOnBeforeMountCbs){y._nuxtOnBeforeMountCbs=[];const l=y._nuxtOnBeforeMountCbs;y&&(J(()=>{l.forEach(m=>{m()}),l.splice(0,l.length)}),R(()=>l.splice(0,l.length)))}d&&a.isHydrating&&c()?i.pending.value=!1:y&&(a.payload.serverRendered&&a.isHydrating||t.lazy)&&t.immediate?y._nuxtOnBeforeMountCbs.push(u):t.immediate&&u(),t.watch&&G(t.watch,()=>i.refresh());const w=a.hook("app:data:refresh",l=>{if(!l||l.includes(r))return i.refresh()});y&&R(w)}const h=Promise.resolve(a._asyncDataPromises[r]).then(()=>i);return Object.assign(h,i),h}function et(s,n){const r={};for(const e of n)r[e]=s[e];return r}const st={ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1};function rt(s,n={}){n={...st,...n};const r=H(n);return r.dispatch(s),r.toString()}function H(s){const n=[];let r=[];const e=t=>{n.push(t)};return{toString(){return n.join("")},getContext(){return r},dispatch(t){return s.replacer&&(t=s.replacer(t)),this["_"+(t===null?"null":typeof t)](t)},_object(t){const a=/\[object (.*)]/i,o=Object.prototype.toString.call(t),c=a.exec(o),i=c?c[1].toLowerCase():"unknown:["+o.toLowerCase()+"]";let u=null;if((u=r.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+u+"]");if(r.push(t),typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(t))return e("buffer:"),e(t.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](t);else{if(s.ignoreUnknown)return e("["+i+"]");throw new Error('Unknown object type "'+i+'"')}else{let d=Object.keys(t);s.unorderedObjects&&(d=d.sort()),s.respectType!==!1&&!U(t)&&d.splice(0,0,"prototype","__proto__","letructor"),s.excludeKeys&&(d=d.filter(function(h){return!s.excludeKeys(h)})),e("object:"+d.length+":");for(const h of d)this.dispatch(h),e(":"),s.excludeValues||this.dispatch(t[h]),e(",")}},_array(t,a){if(a=typeof a<"u"?a:s.unorderedArrays!==!1,e("array:"+t.length+":"),!a||t.length<=1){for(const i of t)this.dispatch(i);return}const o=[],c=t.map(i=>{const u=H(s);return u.dispatch(i),o.push(u.getContext()),u.toString()});return r=[...r,...o],c.sort(),this._array(c,!1)},_date(t){return e("date:"+t.toJSON())},_symbol(t){return e("symbol:"+t.toString())},_error(t){return e("error:"+t.toString())},_boolean(t){return e("bool:"+t.toString())},_string(t){e("string:"+t.length+":"),e(t.toString())},_function(t){e("fn:"),U(t)?this.dispatch("[native]"):this.dispatch(t.toString()),s.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(t.name)),s.respectFunctionProperties&&this._object(t)},_number(t){return e("number:"+t.toString())},_xml(t){return e("xml:"+t.toString())},_null(){return e("Null")},_undefined(){return e("Undefined")},_regexp(t){return e("regex:"+t.toString())},_uint8array(t){return e("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray(t){return e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array(t){return e("int8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array(t){return e("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array(t){return e("int16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array(t){return e("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array(t){return e("int32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array(t){return e("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array(t){return e("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer(t){return e("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url(t){return e("url:"+t.toString())},_map(t){e("map:");const a=[...t];return this._array(a,s.unorderedSets!==!1)},_set(t){e("set:");const a=[...t];return this._array(a,s.unorderedSets!==!1)},_file(t){return e("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},_blob(){if(s.ignoreUnknown)return e("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow(){return e("domwindow")},_bigint(t){return e("bigint:"+t.toString())},_process(){return e("process")},_timer(){return e("timer")},_pipe(){return e("pipe")},_tcp(){return e("tcp")},_udp(){return e("udp")},_tty(){return e("tty")},_statwatcher(){return e("statwatcher")},_securecontext(){return e("securecontext")},_connection(){return e("connection")},_zlib(){return e("zlib")},_context(){return e("context")},_nodescript(){return e("nodescript")},_httpparser(){return e("httpparser")},_dataview(){return e("dataview")},_signal(){return e("signal")},_fsevent(){return e("fsevent")},_tlswrap(){return e("tlswrap")}}}function U(s){return typeof s!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code]\s+}$/i.exec(Function.prototype.toString.call(s))!=null}class ${constructor(n,r){n=this.words=n||[],this.sigBytes=r!==void 0?r:n.length*4}toString(n){return(n||nt).stringify(this)}concat(n){if(this.clamp(),this.sigBytes%4)for(let r=0;r<n.sigBytes;r++){const e=n.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=e<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<n.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=n.words[r>>>2];return this.sigBytes+=n.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new $([...this.words])}}const nt={stringify(s){const n=[];for(let r=0;r<s.sigBytes;r++){const e=s.words[r>>>2]>>>24-r%4*8&255;n.push((e>>>4).toString(16),(e&15).toString(16))}return n.join("")}},at={stringify(s){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=[];for(let e=0;e<s.sigBytes;e+=3){const t=s.words[e>>>2]>>>24-e%4*8&255,a=s.words[e+1>>>2]>>>24-(e+1)%4*8&255,o=s.words[e+2>>>2]>>>24-(e+2)%4*8&255,c=t<<16|a<<8|o;for(let i=0;i<4&&e*8+i*6<s.sigBytes*8;i++)r.push(n.charAt(c>>>6*(3-i)&63))}return r.join("")}},it={parse(s){const n=s.length,r=[];for(let e=0;e<n;e++)r[e>>>2]|=(s.charCodeAt(e)&255)<<24-e%4*8;return new $(r,n)}},ot={parse(s){return it.parse(unescape(encodeURIComponent(s)))}};class ct{constructor(){this._minBufferSize=0,this.blockSize=512/32,this.reset()}reset(){this._data=new $,this._nDataBytes=0}_append(n){typeof n=="string"&&(n=ot.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_doProcessBlock(n,r){}_process(n){let r,e=this._data.sigBytes/(this.blockSize*4);n?e=Math.ceil(e):e=Math.max((e|0)-this._minBufferSize,0);const t=e*this.blockSize,a=Math.min(t*4,this._data.sigBytes);if(t){for(let o=0;o<t;o+=this.blockSize)this._doProcessBlock(this._data.words,o);r=this._data.words.splice(0,t),this._data.sigBytes-=a}return new $(r,a)}}class lt extends ct{update(n){return this._append(n),this._process(),this}finalize(n){n&&this._append(n)}}const ut=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],dt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],B=[];class pt extends lt{constructor(){super(),this.reset()}reset(){super.reset(),this._hash=new $([...ut])}_doProcessBlock(n,r){const e=this._hash.words;let t=e[0],a=e[1],o=e[2],c=e[3],i=e[4],u=e[5],d=e[6],h=e[7];for(let p=0;p<64;p++){if(p<16)B[p]=n[r+p]|0;else{const C=B[p-15],v=(C<<25|C>>>7)^(C<<14|C>>>18)^C>>>3,x=B[p-2],I=(x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10;B[p]=v+B[p-7]+I+B[p-16]}const y=i&u^~i&d,w=t&a^t&o^a&o,l=(t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22),m=(i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25),P=h+m+y+dt[p]+B[p],b=l+w;h=d,d=u,u=i,i=c+P|0,c=o,o=a,a=t,t=P+b|0}e[0]=e[0]+t|0,e[1]=e[1]+a|0,e[2]=e[2]+o|0,e[3]=e[3]+c|0,e[4]=e[4]+i|0,e[5]=e[5]+u|0,e[6]=e[6]+d|0,e[7]=e[7]+h|0}finalize(n){super.finalize(n);const r=this._nDataBytes*8,e=this._data.sigBytes*8;return this._data.words[e>>>5]|=128<<24-e%32,this._data.words[(e+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(e+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}}function ft(s){return new pt().finalize(s).toString(at)}function ht(s,n={}){const r=typeof s=="string"?s:rt(s,n);return ft(r).slice(0,10)}function A(s,n,r){const[e={},t]=typeof n=="string"?[{},n]:[n,r],a=e.key||ht([t,S(e.baseURL),typeof s=="string"?s:"",S(e.params||e.query)]);if(!a||typeof a!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+a);if(!s)throw new Error("[nuxt] [useFetch] request is missing.");const o=a===t?"$f"+a:a,c=q(()=>{let v=s;return typeof v=="function"&&(v=v()),S(v)}),{server:i,lazy:u,default:d,transform:h,pick:p,watch:y,immediate:w,...l}=e,m=Y({...l,cache:typeof e.cache=="boolean"?void 0:e.cache}),P={server:i,lazy:u,default:d,transform:h,pick:p,immediate:w,watch:[m,c,...y||[]]};let b;return tt(o,()=>{var x;return(x=b==null?void 0:b.abort)==null||x.call(b),b=typeof AbortController<"u"?new AbortController:{},typeof c.value=="string"&&c.value.startsWith("/"),(e.$fetch||globalThis.$fetch)(c.value,{signal:b.signal,...m})},P)}const K=()=>{const s=F("place_state",()=>({placesList:[{id:0,name:"",score:0,types:[],userRatingsTotal:0}],inputTextStr:""}));return{state:E(s),updatePlacesList:yt(s),updateInputText:_t(s),fetchPlaces:gt(s)}},yt=s=>n=>s.value.placesList=n,_t=s=>n=>s.value.inputTextStr=n,gt=s=>async(n,r={})=>{const e=j(),t="/google/api/place/nearbysearch/json?",{data:a}=await A(`${t}key=${e.public.googleApiKey}&location=${n.lat},${n.lng}&keyword=${s.value.inputTextStr}&radius=50000&language=ja&types=cafe`,"$eMY8Muq466"),o=a.value.results;s.value.placesList=o.map((c,i)=>({id:i,name:c.name,score:c.rating,types:c.types,userRatingsTotal:c.user_ratings_total}))},T=()=>{const s=F("prefecture_state",()=>({fetchPrefectureList:[{id:0,name:""}],fetchCitiesList:[{id:0,name:""}],inputPref:{id:0,name:""},inputCity:{id:0,name:""},selectedPrefLocation:{lat:0,lng:0}}));return{state:E(s),fetchPrefectures:bt(s),fetchCities:xt(s),fetchGeocode:vt(s),updatePref:mt(s),updateCity:wt(s)}},mt=s=>n=>s.value.inputPref=n,wt=s=>n=>s.value.inputCity=n,bt=s=>async()=>{const n=j(),r="https://opendata.resas-portal.go.jp/api/v1/prefectures",{data:e}=await A(r,{headers:{"X-API-KEY":n.public.resasApiKey}},"$VqUUMtM1id"),a=(await e.value.result).map(o=>({id:o.prefCode,name:o.prefName}));s.value.fetchPrefectureList=a},xt=s=>async()=>{const n=j(),r="https://opendata.resas-portal.go.jp/api/v1/cities?prefCode=",{data:e}=await A(`${r}${s.value.inputPref.id}`,{headers:{"X-API-KEY":n.public.resasApiKey}},"$CzEj24BMpJ"),a=(await e.value.result).map(o=>({id:o.cityCode,name:o.cityName}));s.value.fetchCitiesList=a},vt=s=>async()=>{const n=j(),r="https://maps.googleapis.com/maps/api/geocode/json?",{data:e}=await A(`${r}key=${n.public.googleApiKey}&address=${s.value.inputPref.name}${s.value.inputCity.name}&components=country:JP`,"$CpAGM82Svf"),{lat:t,lng:a}=e.value.results[0].geometry.location;s.value.selectedPrefLocation={lat:t,lng:a}},Bt=f("option",{value:"0",selected:""},"--都道府県を選択--",-1),St=["value"],Pt=z({__name:"PrefSelect",setup(s){const{state:n,updatePref:r,fetchPrefectures:e,fetchCities:t}=T();e();const a=async o=>{const i=o.target.value,u=n.value.fetchPrefectureList.filter(h=>h.id===+i),d={id:u[0].id,name:u[0].name};r(d),t()};return(o,c)=>(_(),g("select",{onChange:a,class:"border rounded px-3 py-2"},[Bt,(_(!0),g(D,null,L(S(n).fetchPrefectureList,i=>(_(),g("option",{key:i.id,value:i.id},k(i.name),9,St))),128))],32))}}),Ct=["value"],kt=["value"],$t=z({__name:"CitySelect",setup(s){const{state:n,updateCity:r}=T(),e=t=>{const a=t.target,o=a.options[a.selectedIndex].value,c=JSON.parse(o);r(c)};return(t,a)=>(_(),g("select",{onChange:e,class:"border rounded px-3 py-2"},[f("option",{value:JSON.stringify({id:0,name:""}),selected:""}," --市区町村を選択-- ",8,Ct),(_(!0),g(D,null,L(S(n).fetchCitiesList,o=>(_(),g("option",{key:o.id,value:JSON.stringify({id:o.id,name:o.name})},k(o.name),9,kt))),128))],32))}}),Dt={class:"px-6 py-2"},Lt={class:"font-bold text-xl mb-2"},jt={class:"flex items-center px-6 py-4"},zt=f("svg",{"aria-hidden":"true",class:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[f("title",null,"Rating star"),f("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),At={class:"ml-2 text-sm font-bold text-gray-900 dark:text-white"},Ot=f("span",{class:"w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"},null,-1),Mt={href:"#",class:"text-sm font-medium text-gray-900 underline hover:no-underline dark:text-white"},Tt={key:0,class:"px-6 pt-4 pb-2"},Nt=z({__name:"Card",setup(s){const{state:n}=K();return(r,e)=>(_(!0),g(D,null,L(S(n).placesList,t=>(_(),g("div",{key:t.id,class:"max-w-sm rounded overflow-hidden shadow-lg"},[f("div",Dt,[f("div",Lt,k(t.name),1)]),f("div",jt,[zt,f("p",At,k(t.score),1),Ot,f("a",Mt,k(t.userRatingsTotal)+" reviews",1)]),t.types?(_(),g("div",Tt,[(_(!0),g(D,null,L(t.types,a=>(_(),g("span",{key:a,class:"inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2"},k(a),1))),128))])):X("",!0)]))),128))}}),Rt={class:"my-5 text-center"},Ut=["onSubmit"],Ft={class:"flex items-center gap-3"},Et=f("button",{class:"bg-blue-500 hover:bg-blue-700 text-white py-2 px-3 rounded",type:"submit"}," 検索 ",-1),Ht={class:"grid grid-cols-3 gap-5"},It=z({__name:"app",setup(s){const{fetchPlaces:n,updateInputText:r}=K(),e=T(),{state:t,fetchGeocode:a}=e,o=async()=>{await a(),await n(t.value.selectedPrefLocation)};return(c,i)=>(_(),g("div",null,[f("div",Rt,[f("form",{action:"",onSubmit:Q(o,["prevent"])},[f("div",Ft,[M(Pt),M($t),Et])],40,Ut)]),f("div",Ht,[M(Nt)])]))}});export{It as default};
